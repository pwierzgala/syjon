{% extends "niobe/course_subjects.html" %}

{% load i18n static %}

{% block js %}
	{# block.super #}
	<script type="text/javascript" src="{% static 'niobe/js/window_popup.js' %}"></script>
{% endblock %}

{% block page_title %}
	{{ block.super }}
	| {{ subject }}
{% endblock %}

{% block breadcrumb %}
	{{ block.super }}
	&raquo; <a href="{% url 'niobe:subject-details' course.id module.id subject.id %}">{{ subject }}</a>
{% endblock %}

{% block content %}
	<div id="subject_form">

		{# zakładamy że moduł przypisany jest tylko do jednej grupy przedmiotów #}
		<table class="table_0">
			<tbody>
			<tr>
				<td>{% trans "Course" %}:</td>
				<td>{{ subject.module.sgroup.course|capfirst }}</td>
			<tr>
				<td>{% trans "Specialty" %}:</td>
				<td>{{ subject.module.sgroup.name|capfirst }}</td>
			</tr>
			<tr>
				{% if subject.module.sgroup.course.years %}
				<td>{% trans "Year" %}:</td>
				{% else %}
				<td>{% trans "Semester" %}:</td>
				{% endif %}
				<td>{{ subject.semester }}</td>
			</tr>
			<tr>
				<td>{% trans "Module" %}:</td>
				<td>{{ subject.module }}</td>
			</tr>
			<tr>
				<td>{% trans "Subject" %}:</td>
				<td>{{ subject }}</td>
			</tr>
			</tbody>
		</table>
		<div class="spacer_10"></div>
		<form action="" method="post">
			{% csrf_token %}
			<table class="table_0">
				<thead>
				<tr>
                    <td></td>
					<td class="left teacher">{% trans "Teacher" %}</td>
					<td class="left groups">{% trans "Number of groups" %}</td>
					<td class="left hours">{% trans "Number of hours" %}</td>
					{% if perms.merovingian.delete_subjecttoteacher %}
					    <td class="center delete">{% trans "Delete" %}</td>
					{% endif %}
				</tr>
				</thead>
				<tbody>
				{{ subject_to_teacher_formset.management_form }}
				{% for form in subject_to_teacher_formset.forms %}
					{{ form.id }}
					<tr class="{% cycle 'odd' 'even' %}">
                        <td class="teacher-link">
                            <a class="link_0 link_preview" href="#"
                               onclick="show_window('{% url "niobe:teacher-list" %}', 'id_subjecttoteacher_set-{{ forloop.counter0 }}-teacher'); return false;"
                            >
                            {% trans "Choose" %}
                            </a>
                        </td>
						<td class="left">
                            {{ form.errors.teacher }}
                            {{ form.teacher }}
						</td>
						<td class="left">
							{{ form.errors.groups }}
							{{ form.groups }}
						</td>
						<td class="left">
							{{ form.errors.hours }}
							{{ form.hours }}
						</td>
						{% if perms.merovingian.delete_subjecttoteacher %}
						<td class="center">
							{{ form.DELETE }}
						</td>
						{% endif %}
					</tr>
				{% endfor %}
				</tbody>
			</table>

			<div class="spacer_10"></div>

			<div class="bar_0">
				<button class="button_2" type="submit" name="action" value="save_and_edit">
					{% trans "Save and stay on this page" %}
				</button>
				<button class="button_2" type="submit" name="action" value="save">
					{% trans "Save and return to the list" %}
				</button>
			</div>
		</form>

	</div>
{% endblock %}
